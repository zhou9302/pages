<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基于SEO的前端渲染方案选型 | 大象的blog</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="this is a blog">
    <link rel="preload" href="/assets/css/0.styles.7950d16d.css" as="style"><link rel="preload" href="/assets/js/app.0a4abb0f.js" as="script"><link rel="preload" href="/assets/js/2.d08ec248.js" as="script"><link rel="preload" href="/assets/js/8.55257e14.js" as="script"><link rel="prefetch" href="/assets/js/3.11572a76.js"><link rel="prefetch" href="/assets/js/4.5ed19beb.js"><link rel="prefetch" href="/assets/js/5.afb2e752.js"><link rel="prefetch" href="/assets/js/6.a3f4581e.js"><link rel="prefetch" href="/assets/js/7.359d20b1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7950d16d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">大象的blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/home.html" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide.html" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/external.html" class="nav-link">
  External
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/home.html" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide.html" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/external.html" class="nav-link">
  External
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/seo/" class="sidebar-heading clickable router-link-active open"><span>seo</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/seo/plan.html" aria-current="page" class="active sidebar-link">基于SEO的前端渲染方案选型</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Group 2</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="基于seo的前端渲染方案选型"><a href="#基于seo的前端渲染方案选型" class="header-anchor">#</a> 基于SEO的前端渲染方案选型</h1> <h4 id="搜索引擎的工作原理"><a href="#搜索引擎的工作原理" class="header-anchor">#</a> 搜索引擎的工作原理:</h4> <ol><li>爬虫在互联网上爬行，从一个链接到另一个链接，对内容进行分析，提炼关键词加入数据库中；如果爬虫认为是垃圾或重复信息，就舍弃继续爬行。当用户搜索时，就能检索出与关键字相关的网址显示给用户。</li> <li>一个关键词对用多个网址，因此就出现了排序的问题，相应的当与关键词最吻合的网址就会排在前面了。在爬虫抓取网页内容，提炼关键词的这个过程中，就存在一个问题：爬虫能否看懂。如果网站内容是 flash 和 js 等，那么它是看不懂的，会犯迷糊，即使关键字再贴切也没用。相应的，如果网站内容可以被搜索引擎能识别，那么搜索引擎就会提高该网站的权重，增加对该网站的友好度。这样一个过程我们称之为 SEO(Search Engine Optimization)，即搜索引擎优化。</li></ol> <h3 id="一、客户端渲染-csr-方案"><a href="#一、客户端渲染-csr-方案" class="header-anchor">#</a> 一、客户端渲染（CSR）方案</h3> <img src="/imgs/SEO/CRS.png" alt="CRS"> <p><strong>SPA:</strong>  在到达浏览器之前的html页面是没有内容的，要等到浏览器执行相应异步请求获取数据填充后才显示界面。</p> <h4 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h4> <ul><li>SPA 的优点（用户体验较好）页面切换流畅且可以添加动画</li></ul> <h4 id="缺点"><a href="#缺点" class="header-anchor">#</a> 缺点</h4> <ul><li>SEO不友好（爬虫如果没有执行js的能力，如百度，获取到的页面是空的，不利于网站推广）</li> <li>首屏加载慢（到达浏览器端后再加载数据，增加用户等待时间）</li></ul> <h3 id="二、服务端渲染-ssr-方案"><a href="#二、服务端渲染-ssr-方案" class="header-anchor">#</a> 二、服务端渲染 （SSR）方案</h3> <img src="/imgs/SEO/SSR.png" alt="SSR"> <p><strong>基本原理</strong>： 在服务端起一个node应用，浏览器到来时，先拦截执行部分 js 异步请求，提前将数据填充到 html 页面中返回浏览器。这样爬虫抓取到的页面就是带数据的，有利于SEO</p> <h4 id="优点-2"><a href="#优点-2" class="header-anchor">#</a> 优点</h4> <ul><li>SEO 友好</li> <li>首屏渲染快（可在服务端缓存页面，请求到来直接给 html）</li></ul> <h4 id="缺点-2"><a href="#缺点-2" class="header-anchor">#</a> 缺点</h4> <ul><li>代码改动大、需要做特定SSR(Nuxt.js,Next.js)框架的改动（经过我们实践、原有SPA代码改动非常大）</li> <li>丢失了部分SPA体验node 容易成为性能瓶颈</li></ul> <h3 id="三、构建时预渲染方案"><a href="#三、构建时预渲染方案" class="header-anchor">#</a> 三、构建时预渲染方案</h3> <p><strong>基本原理</strong>： 利用webpack 等构建工具，针对 SPA 应用开发后只有一个 index.html 文件入口问题，用上述预渲染中间件在前端项目构建时预先获取页面数据，生成多个页面，如 about、help 、contact 等页面，优化首屏渲染与部分页面SEO</p> <table><thead><tr><th>solution</th> <th>github Star</th></tr></thead> <tbody><tr><td>prerender-spa-plugin</td> <td>6k</td></tr> <tr><td>puppeteer</td> <td>63.2k</td></tr> <tr><td>phantomjs</td> <td>1.4k</td></tr></tbody></table> <h4 id="优点-3"><a href="#优点-3" class="header-anchor">#</a> 优点</h4> <ul><li>代码侵入性小</li></ul> <h4 id="缺点-3"><a href="#缺点-3" class="header-anchor">#</a> 缺点</h4> <ul><li>无法用于大量动态路径页面场景（动态路由）</li> <li>无法获取到后台返回的数据</li></ul> <h3 id="四、服务端动态渲染-利用user-agent"><a href="#四、服务端动态渲染-利用user-agent" class="header-anchor">#</a> 四、服务端动态渲染（利用user-agent）</h3> <br> <img src="/imgs/SEO/Render.png" alt="Render"> <p><strong>基本原理</strong>： 服务端对请求的 user-agent 进行判断，浏览器端直接给 SPA 页面，如果是爬虫，给经过动态渲染的 html 页面</p> <h4 id="优点-4"><a href="#优点-4" class="header-anchor">#</a> 优点</h4> <ul><li>兼顾 SPA优点同时解决SEO问题</li></ul> <h4 id="缺点-4"><a href="#缺点-4" class="header-anchor">#</a> 缺点</h4> <ul><li>需要服务端应用（但动态渲染只针对爬虫、不会成为性能瓶颈）</li></ul> <br> <img src="/imgs/SEO/nginx.png" alt="nginx"> <p><strong>社区方案：</strong></p> <table><thead><tr><th>方案</th> <th>github Star</th> <th>描述</th></tr></thead> <tbody><tr><td>puppeteer</td> <td>63.2k</td> <td>可用于动态渲染、前端测试、操作模拟。API丰富</td></tr> <tr><td>rendertron</td> <td>4.9k</td> <td>动态渲染</td></tr> <tr><td>prerender.io</td> <td>5.6k</td> <td>动态渲染</td></tr></tbody></table> <br> <p><strong>动态渲染相比SSR有几点明显好处:</strong></p> <ul><li>和 SSR 一致的 SEO 效果，通过 puppeteer 还可进一步定制 SEO 方案</li> <li>node 应用负载压力小，只需应对爬虫请求，相当于只有爬虫来了页面才做SSR</li> <li>从整体架构上来说相当于一个插件，可随时插拔，无副作用</li> <li>不需要大量修改SPA代码（只在重复请求问题上用一个标志位去识别，当然也可以不管这个问题）</li></ul> <br> <p><strong>常见爬虫 user-agent：</strong></p> <table><thead><tr><th>主题</th> <th>user agent</th> <th>用途</th></tr></thead> <tbody><tr><td>Google</td> <td>googlebot</td> <td>搜索引擎</td></tr> <tr><td>Google</td> <td>google-structured-data-testing-tool</td> <td>测试工具</td></tr> <tr><td>Google</td> <td>Mediapartners-Google</td> <td>Adsense广告网页被访问后，爬虫就来访</td></tr> <tr><td>Microsoft</td> <td>bingbot</td> <td>搜索引擎</td></tr> <tr><td>Linked</td> <td>linkedinbot</td> <td>应用内搜索</td></tr> <tr><td>百度</td> <td>baiduspider</td> <td>搜索引擎</td></tr> <tr><td>奇虎 360</td> <td>360Spider</td> <td>搜索引擎</td></tr> <tr><td>搜狗</td> <td>Sogou Spider</td> <td>搜索引擎</td></tr> <tr><td>Yahoo	Yahoo!</td> <td>Slurp China</td> <td>搜索引擎</td></tr> <tr><td>Yahoo	Yahoo!</td> <td>Slurp</td> <td>搜索引擎</td></tr> <tr><td>Twitter</td> <td>twitterbot</td> <td>应用内搜索</td></tr> <tr><td>Facebook</td> <td>facebookexternalhit</td> <td>应用内搜索</td></tr> <tr><td>-</td> <td>rogerbot</td> <td>-</td></tr> <tr><td>-</td> <td>embedly</td> <td>-</td></tr> <tr><td>Quora</td> <td>quora link preview</td> <td>-</td></tr> <tr><td>-</td> <td>showyoubot</td> <td>-</td></tr> <tr><td>-</td> <td>outbrain</td> <td>-</td></tr> <tr><td>-</td> <td>pinterest</td> <td>-</td></tr> <tr><td>-</td> <td>slackbot</td> <td>-</td></tr> <tr><td>-</td> <td>vkShare</td> <td>-</td></tr> <tr><td>-</td> <td>W3C_Validator</td> <td>-</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0a4abb0f.js" defer></script><script src="/assets/js/2.d08ec248.js" defer></script><script src="/assets/js/8.55257e14.js" defer></script>
  </body>
</html>
